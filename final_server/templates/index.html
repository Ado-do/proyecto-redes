<!doctype html>
<html>
  <head>
    <title>Sensor Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <h1>Industrial IoT Monitor</h1>

    <div style="width: 80%">
      <canvas id="tempChart"></canvas>
    </div>

    <script>
      async function updateData() {
        const response = await fetch("/api/readings?limit=50");
        const readings = await response.json();

        new Chart(document.getElementById("tempChart"), {
          type: "line",
          data: {
            labels: readings.map((r) =>
              new Date(r.timestamp).toLocaleTimeString(),
            ),
            datasets: [
              {
                label: "Temperature (Â°C)",
                data: readings.map((r) => r.temperature),
                borderColor: "rgb(255, 99, 132)",
              },
            ],
          },
        });
      }

      updateData();
      setInterval(updateData, 5000); // Refresh every 5 seconds
    </script>
  </body>
</html>
